[2022-03-01 20:04:00,957] {taskinstance.py:1037} INFO - Dependencies all met for <TaskInstance: dag_flights.read_process_write_file scheduled__2022-02-23T00:00:00+00:00 [queued]>
[2022-03-01 20:04:01,494] {taskinstance.py:1037} INFO - Dependencies all met for <TaskInstance: dag_flights.read_process_write_file scheduled__2022-02-23T00:00:00+00:00 [queued]>
[2022-03-01 20:04:01,494] {taskinstance.py:1243} INFO - 
--------------------------------------------------------------------------------
[2022-03-01 20:04:01,494] {taskinstance.py:1244} INFO - Starting attempt 1 of 1
[2022-03-01 20:04:01,494] {taskinstance.py:1245} INFO - 
--------------------------------------------------------------------------------
[2022-03-01 20:04:03,021] {taskinstance.py:1264} INFO - Executing <Task(PythonOperator): read_process_write_file> on 2022-02-23 00:00:00+00:00
[2022-03-01 20:04:03,242] {standard_task_runner.py:52} INFO - Started process 4081 to run task
[2022-03-01 20:04:03,500] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'dag_flights', 'read_process_write_file', 'scheduled__2022-02-23T00:00:00+00:00', '--job-id', '51', '--raw', '--subdir', 'DAGS_FOLDER/dag_flights.py', '--cfg-path', '/tmp/tmpr1ajup7u', '--error-file', '/tmp/tmp1vfxae7w']
[2022-03-01 20:04:03,514] {standard_task_runner.py:77} INFO - Job 51: Subtask read_process_write_file
[2022-03-01 20:04:05,924] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/models/dagrun.py:466: SAWarning: TypeDecorator UtcDateTime(timezone=True) will not produce a cache key because the ``cache_ok`` attribute is not set to True.  This can have significant performance implications including some performance degradations in comparison to prior SQLAlchemy versions.  Set this attribute to True if this type object's state is safe to use in a cache key, or False to disable this warning. (Background on this error at: https://sqlalche.me/e/14/cprf)
  return session.query(DagRun).filter(*filters).order_by(DagRun.execution_date.desc()).first()

[2022-03-01 20:04:06,006] {logging_mixin.py:109} INFO - Running <TaskInstance: dag_flights.read_process_write_file scheduled__2022-02-23T00:00:00+00:00 [running]> on host 083589a500f4
[2022-03-01 20:04:07,465] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/models/dagrun.py:466: SAWarning: TypeDecorator UtcDateTime(timezone=True) will not produce a cache key because the ``cache_ok`` attribute is not set to True.  This can have significant performance implications including some performance degradations in comparison to prior SQLAlchemy versions.  Set this attribute to True if this type object's state is safe to use in a cache key, or False to disable this warning. (Background on this error at: https://sqlalche.me/e/14/cprf)
  return session.query(DagRun).filter(*filters).order_by(DagRun.execution_date.desc()).first()

[2022-03-01 20:04:07,560] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/models/xcom.py:437: SAWarning: TypeDecorator UtcDateTime(timezone=True) will not produce a cache key because the ``cache_ok`` attribute is not set to True.  This can have significant performance implications including some performance degradations in comparison to prior SQLAlchemy versions.  Set this attribute to True if this type object's state is safe to use in a cache key, or False to disable this warning. (Background on this error at: https://sqlalche.me/e/14/cprf)
  return query.delete()

[2022-03-01 20:04:07,729] {taskinstance.py:1718} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1334, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1423, in _execute_task_with_callbacks
    self.render_templates(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 2011, in render_templates
    self.task.render_template_fields(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/baseoperator.py", line 1061, in render_template_fields
    self._do_render_template_fields(self, self.template_fields, context, jinja_env, set())
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/baseoperator.py", line 1074, in _do_render_template_fields
    rendered_content = self.render_template(content, context, jinja_env, seen_oids)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/baseoperator.py", line 1131, in render_template
    return {key: self.render_template(value, context, jinja_env) for key, value in content.items()}
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/baseoperator.py", line 1131, in <dictcomp>
    return {key: self.render_template(value, context, jinja_env) for key, value in content.items()}
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/baseoperator.py", line 1113, in render_template
    return render_template_to_string(template, context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/helpers.py", line 268, in render_template_to_string
    return render_template(template, context, native=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/helpers.py", line 263, in render_template
    return "".join(nodes)
  File "<template>", line 12, in root
  File "/home/airflow/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 903, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'dict object' has no attribute 'year_csv'
[2022-03-01 20:04:08,635] {taskinstance.py:1282} INFO - Marking task as FAILED. dag_id=dag_flights, task_id=read_process_write_file, execution_date=20220223T000000, start_date=20220301T200400, end_date=20220301T200408
[2022-03-01 20:04:09,578] {standard_task_runner.py:92} ERROR - Failed to execute job 51 for task read_process_write_file
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1334, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1423, in _execute_task_with_callbacks
    self.render_templates(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 2011, in render_templates
    self.task.render_template_fields(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/baseoperator.py", line 1061, in render_template_fields
    self._do_render_template_fields(self, self.template_fields, context, jinja_env, set())
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/baseoperator.py", line 1074, in _do_render_template_fields
    rendered_content = self.render_template(content, context, jinja_env, seen_oids)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/baseoperator.py", line 1131, in render_template
    return {key: self.render_template(value, context, jinja_env) for key, value in content.items()}
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/baseoperator.py", line 1131, in <dictcomp>
    return {key: self.render_template(value, context, jinja_env) for key, value in content.items()}
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/baseoperator.py", line 1113, in render_template
    return render_template_to_string(template, context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/helpers.py", line 268, in render_template_to_string
    return render_template(template, context, native=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/helpers.py", line 263, in render_template
    return "".join(nodes)
  File "<template>", line 12, in root
  File "/home/airflow/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 903, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'dict object' has no attribute 'year_csv'
[2022-03-01 20:04:09,921] {local_task_job.py:212} WARNING - State of this instance has been externally set to failed. Terminating instance.
[2022-03-01 20:04:09,991] {process_utils.py:124} INFO - Sending Signals.SIGTERM to group 4081. PIDs of all processes in the group: [4081]
[2022-03-01 20:04:10,202] {process_utils.py:75} INFO - Sending the signal Signals.SIGTERM to group 4081
[2022-03-01 20:04:10,397] {process_utils.py:70} INFO - Process psutil.Process(pid=4081, status='terminated', exitcode=1, started='20:04:02') (4081) terminated with exit code 1
